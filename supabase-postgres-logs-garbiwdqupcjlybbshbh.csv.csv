detail,error_severity,event_message,hint,id,identifier,timestamp
null,LOG,connection authorized: user=supabase_admin database=postgres application_name=postgres_exporter,null,356a34d4-0a8b-46d8-9152-5705b971d663,garbiwdqupcjlybbshbh,1747150444074000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,0e26bb9b-2a16-4d22-ae3a-ae70109a369d,garbiwdqupcjlybbshbh,1747150443474000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,d05ac1f2-c117-46f7-a756-0519986822c3,garbiwdqupcjlybbshbh,1747150443474000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,3b7633fc-55a1-4556-86ff-0f61dfff95e5,garbiwdqupcjlybbshbh,1747150443473000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,7eda9602-2d8b-4ac5-b4c3-ace2216a20ad,garbiwdqupcjlybbshbh,1747150443473000
null,LOG,connection received: host=2600:1f18:2a66:6e00:8c26:6973:e208:43c port=50172,null,10f5af81-93dc-48fa-98c7-2306ca892479,garbiwdqupcjlybbshbh,1747150443400000
null,LOG,connection received: host=2600:1f18:2a66:6e00:4c75:73ef:18fc:f7ed port=41894,null,b5a9043c-950c-40cb-b525-59bb5a5e4267,garbiwdqupcjlybbshbh,1747150443399000
null,LOG,"connection authorized: user=postgres database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,e2845066-f5b8-4105-890d-b56e7e4dfc30,garbiwdqupcjlybbshbh,1747150379523000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,13046c8f-b30c-4249-949c-11cf47a1e659,garbiwdqupcjlybbshbh,1747150379445000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,def4ae9b-e045-4f4a-826f-17f2390caf1e,garbiwdqupcjlybbshbh,1747150377228000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,4350c938-803e-410a-a0b0-fd49f59984ad,garbiwdqupcjlybbshbh,1747150377218000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,6532fff5-98f5-4ac6-a09d-a673a283bb66,garbiwdqupcjlybbshbh,1747150377218000
null,LOG,connection authorized: user=supabase_admin database=postgres application_name=postgres_exporter,null,3e2d41b7-169c-45ca-ba69-a8ea469cfb78,garbiwdqupcjlybbshbh,1747150324074000
null,LOG,connection received: host=::1 port=17005,null,d0f9124d-7601-4105-a42f-a039cea98d83,garbiwdqupcjlybbshbh,1747150324073000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,7804b98a-11bd-450a-928c-2bd9fc766793,garbiwdqupcjlybbshbh,1747150261530000
null,LOG,"connection authorized: user=postgres database=postgres SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,8d41cfd4-60a4-418a-a4b1-673bfe062903,garbiwdqupcjlybbshbh,1747150261530000
null,LOG,connection received: host=2601:8c:4300:644b:93:dff9:e02c:1209 port=51750,null,abf5e179-bfb9-41a5-98b6-e65b03807a89,garbiwdqupcjlybbshbh,1747150261299000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,b30cf3d6-bf2d-4b60-8f4f-191b1a81bb67,garbiwdqupcjlybbshbh,1747150239736000
null,LOG,"connection authorized: user=postgres database=postgres SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,61883875-5068-47c3-a6cd-1a80c898815e,garbiwdqupcjlybbshbh,1747150239736000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,504b7c64-b415-465f-b61a-3398477b2006,garbiwdqupcjlybbshbh,1747150237847000
null,LOG,"connection authorized: user=postgres database=postgres SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,976c7aa6-6727-457e-a9ff-9b57d2da40dd,garbiwdqupcjlybbshbh,1747150237847000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,78869405-72bf-43aa-bee5-8bc3b7b2622f,garbiwdqupcjlybbshbh,1747150234883000
null,LOG,"connection authorized: user=postgres database=postgres SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,b01b94ac-9fe7-4cc9-85a7-d70273ed5273,garbiwdqupcjlybbshbh,1747150234883000
null,LOG,connection received: host=2601:8c:4300:644b:93:dff9:e02c:1209 port=51746,null,26750009-011b-42f2-ae37-a2d464f442a3,garbiwdqupcjlybbshbh,1747150234668000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,ed54f72a-53a4-4d3d-8e5e-da6cca6235eb,garbiwdqupcjlybbshbh,1747150219199000
null,LOG,"connection authorized: user=postgres database=postgres SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,7cc24146-c3d2-4e60-a31e-73d696283c5e,garbiwdqupcjlybbshbh,1747150219199000
null,LOG,connection received: host=2601:8c:4300:644b:93:dff9:e02c:1209 port=51744,null,8bf2a626-3de8-4d30-ac58-6589a289befe,garbiwdqupcjlybbshbh,1747150218964000
null,LOG,connection authorized: user=supabase_admin database=postgres application_name=postgres_exporter,null,622378d7-be39-4ba0-85cb-4c839621bf26,garbiwdqupcjlybbshbh,1747150204077000
null,LOG,connection received: host=::1 port=10233,null,c631c774-01fd-447f-9d32-7f475c23b475,garbiwdqupcjlybbshbh,1747150204076000
null,LOG,connection authorized: user=supabase_admin database=postgres application_name=postgres_exporter,null,d7817c45-17fa-4260-a819-55a55bcc82ef,garbiwdqupcjlybbshbh,1747150144079000
null,LOG,connection received: host=::1 port=24755,null,35716bd8-5f57-4a85-ae0b-fab2a7b691a7,garbiwdqupcjlybbshbh,1747150144079000
null,LOG,connection authorized: user=supabase_admin database=postgres application_name=postgres_exporter,null,f858bb05-2eda-49d9-81f1-a1fb6ea60092,garbiwdqupcjlybbshbh,1747150084078000
null,LOG,connection received: host=::1 port=22553,null,9a9f228d-1a8a-4d78-b7a1-f74f7f773900,garbiwdqupcjlybbshbh,1747150084077000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,9ec26bdd-e6f1-454e-b8e8-3e79ae7e0606,garbiwdqupcjlybbshbh,1747150054780000
null,LOG,"connection authorized: user=postgres database=postgres SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,c04d84c2-0421-463b-a690-72b6657ed3c4,garbiwdqupcjlybbshbh,1747150054780000
null,LOG,connection received: host=2601:8c:4300:644b:93:dff9:e02c:1209 port=51723,null,0c292dfb-0a6b-49f5-9711-4c957fb71309,garbiwdqupcjlybbshbh,1747150054558000
null,LOG,connection authorized: user=supabase_admin database=postgres application_name=postgres_exporter,null,beae8702-ed57-488a-bdbb-db7a4a58fe02,garbiwdqupcjlybbshbh,1747150024075000
null,LOG,connection received: host=::1 port=6945,null,f941d24e-661a-4377-84ee-8db849d51a94,garbiwdqupcjlybbshbh,1747150024074000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,0b99c4b4-564d-467e-9cc5-cf2c38d5b71d,garbiwdqupcjlybbshbh,1747149991940000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,818e4b01-2edc-4166-b5ff-d1100317a151,garbiwdqupcjlybbshbh,1747149991940000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=realtime_health_check SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,20de207d-5454-4f22-baca-0d73f9e27db3,garbiwdqupcjlybbshbh,1747149991719000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,f59cdd0d-b200-4fbf-a2d2-7ea1ef03e593,garbiwdqupcjlybbshbh,1747149991718000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,32fe5a12-5f94-4ee0-8d32-9c170137d2ce,garbiwdqupcjlybbshbh,1747149991447000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,5f7d994d-7163-4e1f-bf36-93ca27461c85,garbiwdqupcjlybbshbh,1747149991447000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,8593310a-19f0-41c6-b9cb-69303c46efcd,garbiwdqupcjlybbshbh,1747149991447000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,fe1d02d4-a46f-49c4-b1e8-3e118f6c8407,garbiwdqupcjlybbshbh,1747149991447000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,48f5c8ea-de3b-41fd-a6ab-c94e49bbb954,garbiwdqupcjlybbshbh,1747149991345000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,f83b8774-5533-43d0-b740-ce17ccef66b0,garbiwdqupcjlybbshbh,1747149991345000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,61430cdd-afc5-4760-8164-1aee8693f617,garbiwdqupcjlybbshbh,1747149991333000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,50edf0b8-7456-42b8-990c-88d133ece18f,garbiwdqupcjlybbshbh,1747149991333000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,b95ef22d-14d0-419f-8a7e-e889b9a9fde9,garbiwdqupcjlybbshbh,1747149991320000
null,LOG,"connection authorized: user=postgres database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,659f67aa-e060-44d4-a772-15d83e82ebb6,garbiwdqupcjlybbshbh,1747149991320000
null,LOG,connection received: host=2600:1f18:2a66:6e00:1c64:8510:75ba:3d7f port=39226,null,4f2e68fd-dc2b-4dfd-b3e8-a94ec7ddb22c,garbiwdqupcjlybbshbh,1747149991250000
null,LOG,connection received: host=2600:1f18:2a66:6e00:1c64:8510:75ba:3d7f port=39218,null,ae4b38d6-60c2-435f-9dda-5643da4fb3ed,garbiwdqupcjlybbshbh,1747149991233000
null,LOG,connection received: host=2600:1f18:2a66:6e00:1c64:8510:75ba:3d7f port=39202,null,bc4c2328-6009-4879-bfa2-bb7760ae9759,garbiwdqupcjlybbshbh,1747149991226000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,cd6e8899-ac2e-401a-9464-daa5e6146853,garbiwdqupcjlybbshbh,1747149987816000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,1e2dc658-535d-4b86-a8fe-3099dd238cf3,garbiwdqupcjlybbshbh,1747149987816000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,070dd620-c023-411e-96f6-ec4090f0d399,garbiwdqupcjlybbshbh,1747149987814000
null,LOG,"connection authorized: user=postgres database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,927294b3-4789-4736-ad84-82d10fad8664,garbiwdqupcjlybbshbh,1747149987814000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=realtime_health_check SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,3faabec5-efc9-4d22-bb32-014071c95a0d,garbiwdqupcjlybbshbh,1747149987738000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,c88c55f1-197c-46c5-b969-849f1ee1f151,garbiwdqupcjlybbshbh,1747149987738000
null,LOG,connection received: host=2600:1f18:2a66:6e01:686b:8112:b1d0:59fc port=46436,null,fae99b27-84c7-4eb7-88c0-5484e0e18b1b,garbiwdqupcjlybbshbh,1747149987714000
null,LOG,connection received: host=2600:1f18:2a66:6e01:686b:8112:b1d0:59fc port=46430,null,d9f93084-2c57-4eb0-bd40-31df99e356ef,garbiwdqupcjlybbshbh,1747149987713000
null,LOG,connection received: host=2600:1f10:4c1b:cc00:60fe:2095:7176:d339 port=57012,null,86d9cfb2-3f82-437f-8500-3a3166bd6d97,garbiwdqupcjlybbshbh,1747149987617000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,1a12046c-6f6e-4f27-9143-1c2ca69b2ac8,garbiwdqupcjlybbshbh,1747149984180000
null,LOG,"connection authorized: user=postgres database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,4e917e02-3825-47ba-aa67-457e1e8826b2,garbiwdqupcjlybbshbh,1747149984180000
null,LOG,"connection authorized: user=postgres database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,61d90247-4b0f-41fd-b57b-6c732481b747,garbiwdqupcjlybbshbh,1747149984168000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,c24d47b0-45cb-419a-b8ed-b47004c67532,garbiwdqupcjlybbshbh,1747149984168000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,263144dd-6332-4085-bb66-c4740557f3de,garbiwdqupcjlybbshbh,1747149984104000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,5545c1f3-fb92-4d8b-81f5-4da43085e154,garbiwdqupcjlybbshbh,1747149984104000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,453f02b9-b48b-4da7-ab69-7aa4aa0b0d81,garbiwdqupcjlybbshbh,1747149984101000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,578f60b1-1e25-4db0-8f9d-5fe27b4d3415,garbiwdqupcjlybbshbh,1747149984101000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,3bd30c59-9f4d-4d91-9cd2-dfbeddf2080c,garbiwdqupcjlybbshbh,1747149984010000
null,LOG,"connection authorized: user=postgres database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,fa7cc06e-94ba-42c3-aac3-345d7cc14fef,garbiwdqupcjlybbshbh,1747149984010000
null,LOG,"connection authorized: user=postgres database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,12465697-93a7-4ddc-a5c1-d6dc0d79967d,garbiwdqupcjlybbshbh,1747149983976000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,875f6226-78e8-418f-afc2-3ac33d340928,garbiwdqupcjlybbshbh,1747149983976000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,ff3fdd2c-40dd-4d5a-be28-53c686e67c2e,garbiwdqupcjlybbshbh,1747149983934000
null,LOG,"connection authorized: user=postgres database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,0e65f73c-5ac8-4612-8655-e1e9a85d1bcd,garbiwdqupcjlybbshbh,1747149983934000
null,LOG,connection received: host=2600:1f18:2a66:6e00:46c7:692c:2c0e:ff2a port=43896,null,e7b9a767-47c5-4662-8b78-eefbbaa030ae,garbiwdqupcjlybbshbh,1747149983867000
null,LOG,connection received: host=2600:1f18:2a66:6e01:dc86:ca3b:bede:8fa9 port=34118,null,8240b29d-9f80-4840-a731-a175d5ecac5c,garbiwdqupcjlybbshbh,1747149983863000
null,LOG,connection received: host=2600:1f18:2a66:6e00:1c64:8510:75ba:3d7f port=45592,null,33b9ae8d-c16f-457b-b000-0c8cbfe7a365,garbiwdqupcjlybbshbh,1747149983854000
null,LOG,connection received: host=2600:1f18:2a66:6e01:e8d2:9335:e462:3e2f port=60556,null,7ab0e545-3916-4f1d-80b4-b7b3973758af,garbiwdqupcjlybbshbh,1747149983854000
null,LOG,connection received: host=2600:1f18:2a66:6e01:e8d2:9335:e462:3e2f port=60554,null,c474a3a6-f3e5-49cb-bdd0-a67e9d70e2fa,garbiwdqupcjlybbshbh,1747149983821000
null,LOG,"connection authorized: user=postgres database=postgres SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,50d84c5c-2a04-4da1-bdf1-5d5aa985c9d2,garbiwdqupcjlybbshbh,1747149944970000
null,LOG,"connection authenticated: identity=""postgres"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,77f015c1-4642-4ad2-9fed-244069eacc12,garbiwdqupcjlybbshbh,1747149944970000
null,LOG,connection received: host=2601:8c:4300:644b:93:dff9:e02c:1209 port=51690,null,a8c2cf49-3f81-4e71-af8b-4d29a5876ab7,garbiwdqupcjlybbshbh,1747149944718000
null,LOG,connection authorized: user=supabase_admin database=postgres application_name=postgres_exporter,null,7e9bf458-4485-4560-836a-daf21058034c,garbiwdqupcjlybbshbh,1747149904076000
null,LOG,connection received: host=::1 port=7999,null,6ab6dfc8-cac1-4faf-b09d-f852dc75ea2b,garbiwdqupcjlybbshbh,1747149904075000
null,LOG,connection received: host=::1 port=55833,null,1cf72214-7cad-4c61-82c5-4353b402cb28,garbiwdqupcjlybbshbh,1747149844071000
null,LOG,connection authorized: user=supabase_admin database=postgres application_name=postgres_exporter,null,7e01c8b7-e33f-4102-aa5f-c66477b7f4ea,garbiwdqupcjlybbshbh,1747149844071000
null,LOG,connection authorized: user=supabase_admin database=postgres application_name=postgres_exporter,null,4c41b4ce-05d6-45a7-9e06-932f2b682a4f,garbiwdqupcjlybbshbh,1747149784070000
null,LOG,connection received: host=::1 port=34651,null,c80e4899-d77a-403d-b080-2c6a176adf30,garbiwdqupcjlybbshbh,1747149784068000
null,LOG,connection authorized: user=supabase_admin database=postgres application_name=postgres_exporter,null,5ceb332d-6bac-42c0-beeb-c79e55a87713,garbiwdqupcjlybbshbh,1747149724068000
null,LOG,connection received: host=::1 port=52285,null,3b40ff68-bbd2-454e-8de9-c1a49b0c30db,garbiwdqupcjlybbshbh,1747149724067000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,052a4180-c382-46cd-8072-8755a71e96ab,garbiwdqupcjlybbshbh,1747149681890000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,7324d7c8-2aab-4fce-9510-97807182ecfc,garbiwdqupcjlybbshbh,1747149681890000
null,LOG,"connection authenticated: identity=""supabase_admin"" method=scram-sha-256 (/etc/postgresql/pg_hba.conf:94)",null,0b9d4efc-318c-4f95-9445-6b975a44cedd,garbiwdqupcjlybbshbh,1747149681882000
null,LOG,"connection authorized: user=supabase_admin database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,e6c7fc4a-8b78-4785-a960-7b158c78c0d6,garbiwdqupcjlybbshbh,1747149681882000
null,LOG,"statement: DROP TYPE IF EXISTS pg_temp.tabledefs CASCADE;CREATE TYPE pg_temp.tabledefs AS ENUM('PKEY_INTERNAL','PKEY_EXTERNAL','FKEYS_INTERNAL','FKEYS_EXTERNAL','COMMENTS','FKEYS_NONE','INCLUDE_TRIGGERS','NO_TRIGGERS');CREATE OR REPLACE FUNCTION pg_temp.pg_get_coldef(in_schema text,in_table text,in_column text,oldway boolean default False)RETURNS text LANGUAGE plpgsql VOLATILE AS $$ DECLARE v_coldef text;v_dt1 text;v_dt2 text;v_dt3 text;v_nullable boolean;v_position int;v_identity text;v_generated text;v_hasdflt boolean;v_dfltexpr text;BEGIN IF oldway THEN SELECT pg_catalog.format_type(a.atttypid,a.atttypmod)INTO v_coldef FROM pg_namespace n,pg_class c,pg_attribute a,pg_type t WHERE n.nspname=in_schema AND n.oid=c.relnamespace AND c.relname=in_table AND a.attname=in_column and a.attnum>0 AND a.attrelid=c.oid AND a.atttypid=t.oid ORDER BY a.attnum;ELSE SELECT CASE WHEN a.atttypid=ANY('{int,int8,int2}'::regtype[])AND EXISTS(SELECT FROM pg_attrdef ad WHERE ad.adrelid=a.attrelid AND ad.adnum=a.attnum AND pg_get_expr(ad.adbin,ad.adrelid)='nextval('''||(pg_get_serial_sequence(a.attrelid::regclass::text,a.attname))::regclass||'''::regclass)')THEN CASE a.atttypid WHEN'int'::regtype THEN'serial'WHEN'int8'::regtype THEN'bigserial'WHEN'int2'::regtype THEN'smallserial'END ELSE format_type(a.atttypid,a.atttypmod)END AS data_type INTO v_coldef FROM pg_namespace n,pg_class c,pg_attribute a,pg_type t WHERE n.nspname=in_schema AND n.oid=c.relnamespace AND c.relname=in_table AND a.attname=in_column and a.attnum>0 AND a.attrelid=c.oid AND a.atttypid=t.oid ORDER BY a.attnum;END IF;RETURN v_coldef;END;$$;DROP FUNCTION IF EXISTS pg_temp.pg_get_tabledef(character varying,character varying,boolean,tabledefs[]);CREATE OR REPLACE FUNCTION pg_temp.pg_get_tabledef(in_schema varchar,in_table varchar,_verbose boolean,VARIADIC arr pg_temp.tabledefs[]DEFAULT'{}'::pg_temp.tabledefs[])RETURNS text LANGUAGE plpgsql VOLATILE AS $$ DECLARE v_qualified text:='';v_table_ddl text;v_table_oid int;v_colrec record;v_constraintrec record;v_trigrec record;v_indexrec record;v_rec record;v_constraint_name text;v_constraint_def text;v_pkey_def text:='';v_fkey_def text:='';v_fkey_defs text:='';v_trigger text:='';v_partition_key text:='';v_partbound text;v_parent text;v_parent_schema text;v_persist text;v_temp text:='';v_temp2 text;v_relopts text;v_tablespace text;v_pgversion int;bSerial boolean;bPartition boolean;bInheritance boolean;bRelispartition boolean;constraintarr text[]:='{}';constraintelement text;bSkip boolean;bVerbose boolean:=False;v_cnt1 integer;v_cnt2 integer;search_path_old text:='';search_path_new text:='';v_partial boolean;v_pos integer;pkcnt int:=0;fkcnt int:=0;trigcnt int:=0;cmtcnt int:=0;pktype pg_temp.tabledefs:='PKEY_INTERNAL';fktype pg_temp.tabledefs:='FKEYS_INTERNAL';trigtype pg_temp.tabledefs:='NO_TRIGGERS';arglen integer;vargs text;avarg pg_temp.tabledefs;v_ret text;v_diag1 text;v_diag2 text;v_diag3 text;v_diag4 text;v_diag5 text;v_diag6 text;BEGIN SET client_min_messages='notice';IF _verbose THEN bVerbose=True;END IF;arglen:=array_length($4,1);IF arglen IS NULL THEN NULL;ELSE IF bVerbose THEN RAISE NOTICE'arguments=%',$4;END IF;FOREACH avarg IN ARRAY $4 LOOP IF bVerbose THEN RAISE NOTICE'arg=%',avarg;END IF;IF avarg='FKEYS_INTERNAL'OR avarg='FKEYS_EXTERNAL'OR avarg='FKEYS_NONE'THEN fkcnt=fkcnt+1;fktype=avarg;ELSEIF avarg='INCLUDE_TRIGGERS'OR avarg='NO_TRIGGERS'THEN trigcnt=trigcnt+1;trigtype=avarg;ELSEIF avarg='PKEY_EXTERNAL'THEN pkcnt=pkcnt+1;pktype=avarg;ELSEIF avarg='COMMENTS'THEN cmtcnt=cmtcnt+1;END IF;END LOOP;IF fkcnt>1 THEN RAISE WARNING'Only one foreign key option can be provided. You provided %',fkcnt;RETURN'';ELSEIF trigcnt>1 THEN RAISE WARNING'Only one trigger option can be provided. You provided %',trigcnt;RETURN'';ELSEIF pkcnt>1 THEN RAISE WARNING'Only one pkey option can be provided. You provided %',pkcnt;RETURN'';ELSEIF cmtcnt>1 THEN RAISE WARNING'Only one comments option can be provided. You provided %',cmtcnt;RETURN'';END IF;END IF;SELECT c.oid,(select setting from pg_settings where name='server_version_num')INTO v_table_oid,v_pgversion FROM pg_catalog.pg_class c LEFT JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace WHERE c.relkind in('r','p')AND c.relname=in_table AND n.nspname=in_schema;SELECT setting INTO search_path_old FROM pg_settings WHERE name='search_path';EXECUTE'SET search_path = ""public""';SELECT setting INTO search_path_new FROM pg_settings WHERE name='search_path';IF(v_table_oid IS NULL)THEN RAISE EXCEPTION'table does not exist';END IF;SELECT tablespace INTO v_temp FROM pg_tables WHERE schemaname=in_schema and tablename=in_table and tablespace IS NOT NULL;IF v_temp IS NULL THEN v_tablespace:='TABLESPACE pg_default';ELSE v_tablespace:='TABLESPACE '||v_temp;END IF;WITH relopts AS(SELECT unnest(c.reloptions)relopts FROM pg_class c,pg_namespace n WHERE n.nspname=in_schema and n.oid=c.relnamespace and c.relname=in_table)SELECT string_agg(r.relopts,', ')as relopts INTO v_temp from relopts r;IF v_temp IS NULL THEN v_relopts:='';ELSE v_relopts:=' WITH ('||v_temp||')';END IF;v_partbound:='';bPartition:=False;bInheritance:=False;IF v_pgversion<100000 THEN SELECT c2.relname parent,c2.relnamespace::regnamespace INTO v_parent,v_parent_schema from pg_class c1,pg_namespace n,pg_inherits i,pg_class c2 WHERE n.nspname=in_schema and n.oid=c1.relnamespace and c1.relname=in_table and c1.oid=i.inhrelid and i.inhparent=c2.oid and c1.relkind='r';IF(v_parent IS NOT NULL)THEN bPartition:=True;bInheritance:=True;END IF;ELSE SELECT c2.relname parent,c1.relispartition,pg_get_expr(c1.relpartbound,c1.oid,true),c2.relnamespace::regnamespace INTO v_parent,bRelispartition,v_partbound,v_parent_schema from pg_class c1,pg_namespace n,pg_inherits i,pg_class c2 WHERE n.nspname=in_schema and n.oid=c1.relnamespace and c1.relname=in_table and c1.oid=i.inhrelid and i.inhparent=c2.oid and c1.relkind='r';IF(v_parent IS NOT NULL)THEN bPartition:=True;IF bRelispartition THEN bInheritance:=False;ELSE bInheritance:=True;END IF;END IF;END IF;IF bPartition THEN SELECT count(*)INTO v_cnt1 FROM information_schema.tables t WHERE EXISTS(SELECT REGEXP_MATCHES(s.table_name,'([A-Z]+)','g')FROM information_schema.tables s WHERE t.table_schema=s.table_schema AND t.table_name=s.table_name AND t.table_schema=in_schema AND t.table_name=in_table AND t.table_type='BASE TABLE');SELECT COUNT(*)INTO v_cnt2 FROM pg_get_keywords()WHERE word=in_table AND catcode='R';IF bInheritance THEN IF v_cnt1>0 OR v_cnt2>0 THEN v_table_ddl:='CREATE TABLE '||in_schema||'.""'||in_table||'""( '||E'\n';ELSE v_table_ddl:='CREATE TABLE '||in_schema||'.'||in_table||'( '||E'\n';END IF;ELSE IF v_relopts<>''THEN IF v_cnt1>0 OR v_cnt2>0 THEN v_table_ddl:='CREATE TABLE '||in_schema||'.""'||in_table||'"" PARTITION OF '||in_schema||'.'||v_parent||' '||v_partbound||v_relopts||' '||v_tablespace||'; '||E'\n';ELSE v_table_ddl:='CREATE TABLE '||in_schema||'.'||in_table||' PARTITION OF '||in_schema||'.'||v_parent||' '||v_partbound||v_relopts||' '||v_tablespace||'; '||E'\n';END IF;ELSE IF v_cnt1>0 OR v_cnt2>0 THEN v_table_ddl:='CREATE TABLE '||in_schema||'.""'||in_table||'"" PARTITION OF '||in_schema||'.'||v_parent||' '||v_partbound||' '||v_tablespace||'; '||E'\n';ELSE v_table_ddl:='CREATE TABLE '||in_schema||'.'||in_table||' PARTITION OF '||in_schema||'.'||v_parent||' '||v_partbound||' '||v_tablespace||'; '||E'\n';END IF;END IF;END IF;END IF;IF bVerbose THEN RAISE NOTICE'(1)tabledef so far: %',v_table_ddl;END IF;IF NOT bPartition THEN select c.relpersistence into v_persist from pg_class c,pg_namespace n where n.nspname=in_schema and n.oid=c.relnamespace and c.relname=in_table and c.relkind='r';IF v_persist='u'THEN v_temp:='UNLOGGED';ELSIF v_persist='t'THEN v_temp:='TEMPORARY';ELSE v_temp:='';END IF;END IF;IF NOT bPartition THEN SELECT count(*)INTO v_cnt1 FROM information_schema.tables t WHERE EXISTS(SELECT REGEXP_MATCHES(s.table_name,'([A-Z]+)','g')FROM information_schema.tables s WHERE t.table_schema=s.table_schema AND t.table_name=s.table_name AND t.table_schema=in_schema AND t.table_name=in_table AND t.table_type='BASE TABLE');IF v_cnt1>0 THEN v_table_ddl:='CREATE '||v_temp||' TABLE '||in_schema||'.""'||in_table||'"" ('||E'\n';ELSE v_table_ddl:='CREATE '||v_temp||' TABLE '||in_schema||'.'||in_table||' ('||E'\n';END IF;END IF;IF NOT bPartition THEN FOR v_colrec IN SELECT c.column_name,c.data_type,c.udt_name,c.udt_schema,c.character_maximum_length,c.is_nullable,c.column_default,c.numeric_precision,c.numeric_scale,c.is_identity,c.identity_generation,c.is_generated,c.generation_expression FROM information_schema.columns c WHERE(table_schema,table_name)=(in_schema,in_table)ORDER BY ordinal_position LOOP IF bVerbose THEN RAISE NOTICE'(col loop) name=%  type=%  udt_name=%  default=%  is_generated=%  gen_expr=%',v_colrec.column_name,v_colrec.data_type,v_colrec.udt_name,v_colrec.column_default,v_colrec.is_generated,v_colrec.generation_expression;END IF;SELECT CASE WHEN pg_get_serial_sequence(quote_ident(in_schema)||'.'||quote_ident(in_table),v_colrec.column_name)IS NOT NULL THEN True ELSE False END into bSerial;IF bVerbose THEN SELECT pg_get_serial_sequence(quote_ident(in_schema)||'.'||quote_ident(in_table),v_colrec.column_name)into v_temp;IF v_temp IS NULL THEN v_temp='NA';END IF;SELECT pg_temp.pg_get_coldef(in_schema,in_table,v_colrec.column_name)INTO v_diag1;RAISE NOTICE'DEBUG table: %  Column: %  datatype: %  Serial=%  serialval=%  coldef=%',v_qualified,v_colrec.column_name,v_colrec.data_type,bSerial,v_temp,v_diag1;RAISE NOTICE'DEBUG tabledef: %',v_table_ddl;END IF;SELECT COUNT(*)INTO v_cnt1 FROM information_schema.columns t WHERE EXISTS(SELECT REGEXP_MATCHES(s.column_name,'([A-Z]+)','g')FROM information_schema.columns s WHERE t.table_schema=s.table_schema and t.table_name=s.table_name and t.column_name=s.column_name AND t.table_schema=quote_ident(in_schema)AND column_name=v_colrec.column_name);SELECT COUNT(*)INTO v_cnt2 FROM pg_get_keywords()WHERE word=v_colrec.column_name AND catcode='R';IF v_cnt1>0 OR v_cnt2>0 THEN v_table_ddl:=v_table_ddl||'  ""'||v_colrec.column_name||'"" ';ELSE v_table_ddl:=v_table_ddl||'  '||v_colrec.column_name||' ';END IF;IF v_colrec.is_generated='ALWAYS'and v_colrec.generation_expression IS NOT NULL THEN v_temp=v_colrec.data_type||' GENERATED ALWAYS AS ('||v_colrec.generation_expression||') STORED ';ELSEIF v_colrec.udt_name in('geometry','box2d','box2df','box3d','geography','geometry_dump','gidx','spheroid','valid_detail')THEN v_temp=v_colrec.udt_name;ELSEIF v_colrec.data_type='USER-DEFINED'THEN v_temp=v_colrec.udt_schema||'.'||v_colrec.udt_name;ELSEIF v_colrec.data_type='ARRAY'THEN v_temp=pg_temp.pg_get_coldef(in_schema,in_table,v_colrec.column_name);ELSEIF pg_get_serial_sequence(quote_ident(in_schema)||'.'||quote_ident(in_table),v_colrec.column_name)IS NOT NULL THEN v_temp=pg_temp.pg_get_coldef(in_schema,in_table,v_colrec.column_name);ELSE v_temp=v_colrec.data_type;END IF;IF v_colrec.is_identity='YES'THEN IF v_colrec.identity_generation='ALWAYS'THEN v_temp=v_temp||' GENERATED ALWAYS AS IDENTITY';ELSE v_temp=v_temp||' GENERATED BY DEFAULT AS IDENTITY';END IF;ELSEIF v_colrec.character_maximum_length IS NOT NULL THEN v_temp=v_temp||('('||v_colrec.character_maximum_length||')');ELSEIF v_colrec.numeric_precision>0 AND v_colrec.numeric_scale>0 THEN v_temp=v_temp||'('||v_colrec.numeric_precision||','||v_colrec.numeric_scale||')';END IF;IF bSerial THEN v_temp=v_temp||' NOT NULL';ELSEIF v_colrec.is_nullable='NO'THEN v_temp=v_temp||' NOT NULL';ELSEIF v_colrec.is_nullable='YES'THEN v_temp=v_temp||' NULL';END IF;IF v_colrec.column_default IS NOT null AND NOT bSerial THEN v_temp=v_temp||(' DEFAULT '||v_colrec.column_default);END IF;v_temp=v_temp||','||E'\n';v_table_ddl:=v_table_ddl||v_temp;END LOOP;END IF;IF bVerbose THEN RAISE NOTICE'(2)tabledef so far: %',v_table_ddl;END IF;IF v_pgversion<110000 THEN FOR v_constraintrec IN SELECT con.conname as constraint_name,con.contype as constraint_type,CASE WHEN con.contype='p'THEN 1 WHEN con.contype='u'THEN 2 WHEN con.contype='f'THEN 3 WHEN con.contype='c'THEN 4 ELSE 5 END as type_rank,pg_get_constraintdef(con.oid)as constraint_definition FROM pg_catalog.pg_constraint con JOIN pg_catalog.pg_class rel ON rel.oid=con.conrelid JOIN pg_catalog.pg_namespace nsp ON nsp.oid=connamespace WHERE nsp.nspname=in_schema AND rel.relname=in_table ORDER BY type_rank LOOP v_constraint_name:=v_constraintrec.constraint_name;v_constraint_def:=v_constraintrec.constraint_definition;IF v_constraintrec.type_rank=1 THEN IF pkcnt=0 OR pktype='PKEY_INTERNAL'THEN v_constraint_name:=v_constraintrec.constraint_name;v_constraint_def:=v_constraintrec.constraint_definition;v_table_ddl:=v_table_ddl||'  '||'CONSTRAINT'||' '||v_constraint_name||' '||v_constraint_def||','||E'\n';ELSE SELECT'ALTER TABLE ONLY '||in_schema||'.'||c.relname||' ADD CONSTRAINT '||r.conname||' '||pg_catalog.pg_get_constraintdef(r.oid,true)||';'INTO v_pkey_def FROM pg_catalog.pg_constraint r,pg_class c,pg_namespace n where r.conrelid=c.oid and r.contype='p'and n.oid=r.connamespace and n.nspname=in_schema AND c.relname=in_table and r.conname=v_constraint_name;END IF;IF bPartition THEN continue;END IF;ELSIF v_constraintrec.type_rank=3 THEN IF fktype='FKEYS_NONE'THEN continue;ELSIF fkcnt=0 OR fktype='FKEYS_INTERNAL'THEN v_table_ddl:=v_table_ddl||'  '||'CONSTRAINT'||' '||v_constraint_name||' '||v_constraint_def||','||E'\n';ELSE SELECT'ALTER TABLE ONLY '||n.nspname||'.'||c2.relname||' ADD CONSTRAINT '||r.conname||' '||pg_catalog.pg_get_constraintdef(r.oid,true)||';'INTO v_fkey_def FROM pg_constraint r,pg_class c1,pg_namespace n,pg_class c2 where r.conrelid=c1.oid and r.contype='f'and n.nspname=in_schema and n.oid=r.connamespace and r.conrelid=c2.oid and c2.relname=in_table;v_fkey_defs=v_fkey_defs||v_fkey_def||E'\n';END IF;ELSE v_table_ddl:=v_table_ddl||'  '||'CONSTRAINT'||' '||v_constraint_name||' '||v_constraint_def||','||E'\n';END IF;if bVerbose THEN RAISE NOTICE'DEBUG4: constraint name=% constraint_def=%',v_constraint_name,v_constraint_def;END IF;constraintarr:=constraintarr||v_constraintrec.constraint_name::text;END LOOP;ELSE FOR v_constraintrec IN SELECT con.conname as constraint_name,con.contype as constraint_type,CASE WHEN con.contype='p'THEN 1 WHEN con.contype='u'THEN 2 WHEN con.contype='f'THEN 3 WHEN con.contype='c'THEN 4 ELSE 5 END as type_rank,pg_get_constraintdef(con.oid)as constraint_definition FROM pg_catalog.pg_constraint con JOIN pg_catalog.pg_class rel ON rel.oid=con.conrelid JOIN pg_catalog.pg_namespace nsp ON nsp.oid=connamespace WHERE nsp.nspname=in_schema AND rel.relname=in_table AND con.conparentid=0 ORDER BY type_rank LOOP v_constraint_name:=v_constraintrec.constraint_name;v_constraint_def:=v_constraintrec.constraint_definition;IF v_constraintrec.type_rank=1 THEN IF pkcnt=0 OR pktype='PKEY_INTERNAL'THEN v_constraint_name:=v_constraintrec.constraint_name;v_constraint_def:=v_constraintrec.constraint_definition;v_table_ddl:=v_table_ddl||'  '||'CONSTRAINT'||' '||v_constraint_name||' '||v_constraint_def||','||E'\n';ELSE SELECT'ALTER TABLE ONLY '||in_schema||'.'||c.relname||' ADD CONSTRAINT '||r.conname||' '||pg_catalog.pg_get_constraintdef(r.oid,true)||';'INTO v_pkey_def FROM pg_catalog.pg_constraint r,pg_class c,pg_namespace n where r.conrelid=c.oid and r.contype='p'and n.oid=r.connamespace and n.nspname=in_schema AND c.relname=in_table;END IF;IF bPartition THEN continue;END IF;ELSIF v_constraintrec.type_rank=3 THEN IF fktype='FKEYS_NONE'THEN continue;ELSIF fkcnt=0 OR fktype='FKEYS_INTERNAL'THEN v_table_ddl:=v_table_ddl||'  '||'CONSTRAINT'||' '||v_constraint_name||' '||v_constraint_def||','||E'\n';ELSE SELECT'ALTER TABLE ONLY '||n.nspname||'.'||c2.relname||' ADD CONSTRAINT '||r.conname||' '||pg_catalog.pg_get_constraintdef(r.oid,true)||';'INTO v_fkey_def FROM pg_constraint r,pg_class c1,pg_namespace n,pg_class c2 where r.conrelid=c1.oid and r.contype='f'and n.nspname=in_schema and n.oid=r.connamespace and r.conrelid=c2.oid and c2.relname=in_table and r.conname=v_constraint_name and r.conparentid=0;v_fkey_defs=v_fkey_defs||v_fkey_def||E'\n';END IF;ELSE v_table_ddl:=v_table_ddl||'  '||'CONSTRAINT'||' '||v_constraint_name||' '||v_constraint_def||','||E'\n';END IF;if bVerbose THEN RAISE NOTICE'DEBUG4: constraint name=% constraint_def=%',v_constraint_name,v_constraint_def;END IF;constraintarr:=constraintarr||v_constraintrec.constraint_name::text;END LOOP;END IF;select substring(v_table_ddl,length(v_table_ddl)-1,1)INTO v_temp;IF v_temp=','THEN v_table_ddl=substr(v_table_ddl,0,length(v_table_ddl)-1)||E'\n';END IF;IF bVerbose THEN RAISE NOTICE'(3)tabledef so far: %',trim(v_table_ddl);END IF;IF bVerbose THEN RAISE NOTICE'(4)tabledef so far: %',v_table_ddl;END IF;IF bPartition and bInheritance THEN IF v_parent_schema=''OR v_parent_schema IS NULL THEN v_parent_schema=in_schema;END IF;v_table_ddl:=v_table_ddl||') INHERITS ('||v_parent_schema||'.'||v_parent||') '||E'\n'||v_relopts||' '||v_tablespace||';'||E'\n';END IF;IF v_pgversion>=100000 AND NOT bPartition and NOT bInheritance THEN SELECT pg_get_partkeydef(c1.oid)as partition_key INTO v_partition_key FROM pg_class c1 JOIN pg_namespace n ON(n.oid=c1.relnamespace)LEFT JOIN pg_partitioned_table p ON(c1.oid=p.partrelid)WHERE n.nspname=in_schema and n.oid=c1.relnamespace and c1.relname=in_table and c1.relkind='p';IF v_partition_key IS NOT NULL AND v_partition_key<>''THEN v_table_ddl:=v_table_ddl||') PARTITION BY '||v_partition_key||';'||E'\n';ELSEIF v_relopts<>''THEN v_table_ddl:=v_table_ddl||') '||v_relopts||' '||v_tablespace||';'||E'\n';ELSE v_table_ddl:=v_table_ddl||') '||v_tablespace||';'||E'\n';END IF;END IF;IF bVerbose THEN RAISE NOTICE'(5)tabledef so far: %',v_table_ddl;END IF;IF v_pkey_def<>''THEN v_table_ddl:=v_table_ddl||v_pkey_def||E'\n';END IF;IF v_fkey_defs<>''THEN v_table_ddl:=v_table_ddl||v_fkey_defs||E'\n';END IF;IF bVerbose THEN RAISE NOTICE'(6)tabledef so far: %',v_table_ddl;END IF;FOR v_indexrec IN SELECT indexdef,COALESCE(tablespace,'pg_default')as tablespace,indexname FROM pg_indexes WHERE(schemaname,tablename)=(in_schema,in_table)LOOP bSkip=False;FOREACH constraintelement IN ARRAY constraintarr LOOP IF constraintelement=v_indexrec.indexname THEN bSkip=True;EXIT;END IF;END LOOP;if bSkip THEN CONTINUE;END IF;v_indexrec.indexdef:=REPLACE(v_indexrec.indexdef,'CREATE INDEX','CREATE INDEX IF NOT EXISTS');v_indexrec.indexdef:=REPLACE(v_indexrec.indexdef,'CREATE UNIQUE INDEX','CREATE UNIQUE INDEX IF NOT EXISTS');IF v_partition_key IS NOT NULL AND v_partition_key<>''THEN v_table_ddl:=v_table_ddl||v_indexrec.indexdef||';'||E'\n';ELSE select CASE WHEN i.indpred IS NOT NULL THEN True ELSE False END INTO v_partial FROM pg_index i JOIN pg_class c1 ON(i.indexrelid=c1.oid)JOIN pg_class c2 ON(i.indrelid=c2.oid)WHERE c1.relnamespace::regnamespace::text=in_schema AND c2.relnamespace::regnamespace::text=in_schema AND c2.relname=in_table AND c1.relname=v_indexrec.indexname;IF v_partial THEN v_temp=v_indexrec.indexdef;v_pos=POSITION(' WHERE 'IN v_temp);v_temp2=SUBSTRING(v_temp,v_pos);v_temp=SUBSTRING(v_temp,1,v_pos);v_table_ddl:=v_table_ddl||v_temp||' TABLESPACE '||v_indexrec.tablespace||v_temp2||';'||E'\n';ELSE v_table_ddl:=v_table_ddl||v_indexrec.indexdef||' TABLESPACE '||v_indexrec.tablespace||';'||E'\n';END IF;END IF;END LOOP;IF bVerbose THEN RAISE NOTICE'(7)tabledef so far: %',v_table_ddl;END IF;IF cmtcnt>0 THEN FOR v_rec IN SELECT c.relname,'COMMENT ON '||CASE WHEN c.relkind in('r','p')AND a.attname IS NULL THEN'TABLE 'WHEN c.relkind in('r','p')AND a.attname IS NOT NULL THEN'COLUMN 'WHEN c.relkind='f'THEN'FOREIGN TABLE 'WHEN c.relkind='m'THEN'MATERIALIZED VIEW 'WHEN c.relkind='v'THEN'VIEW 'WHEN c.relkind='i'THEN'INDEX 'WHEN c.relkind='S'THEN'SEQUENCE 'ELSE'XX'END||n.nspname||'.'||CASE WHEN c.relkind in('r','p')AND a.attname IS NOT NULL THEN quote_ident(c.relname)||'.'||a.attname ELSE quote_ident(c.relname)END||' IS '||quote_literal(d.description)||';'as ddl FROM pg_class c JOIN pg_namespace n ON(n.oid=c.relnamespace)LEFT JOIN pg_description d ON(c.oid=d.objoid)LEFT JOIN pg_attribute a ON(c.oid=a.attrelid AND a.attnum>0 and a.attnum=d.objsubid)WHERE d.description IS NOT NULL AND n.nspname=in_schema AND c.relname=in_table ORDER BY 2 desc,ddl LOOP v_table_ddl=v_table_ddl||v_rec.ddl||E'\n';END LOOP;END IF;IF bVerbose THEN RAISE NOTICE'(8)tabledef so far: %',v_table_ddl;END IF;IF trigtype='INCLUDE_TRIGGERS'THEN FOR v_trigrec IN select pg_get_triggerdef(t.oid,True)||';'as triggerdef FROM pg_trigger t,pg_class c,pg_namespace n WHERE n.nspname=in_schema and n.oid=c.relnamespace and c.relname=in_table and c.relkind='r'and t.tgrelid=c.oid and NOT t.tgisinternal LOOP v_table_ddl:=v_table_ddl||v_trigrec.triggerdef;v_table_ddl:=v_table_ddl||E'\n';IF bVerbose THEN RAISE NOTICE'triggerdef = %',v_trigrec.triggerdef;END IF;END LOOP;END IF;IF bVerbose THEN RAISE NOTICE'(9)tabledef so far: %',v_table_ddl;END IF;v_table_ddl:=v_table_ddl||E'\n';IF bVerbose THEN RAISE NOTICE'(10)tabledef so far: %',v_table_ddl;END IF;IF search_path_old=''THEN SELECT set_config('search_path','',false)into v_temp;ELSE EXECUTE'SET search_path = '||search_path_old;END IF;RETURN v_table_ddl;EXCEPTION WHEN others THEN BEGIN GET STACKED DIAGNOSTICS v_diag1=MESSAGE_TEXT,v_diag2=PG_EXCEPTION_DETAIL,v_diag3=PG_EXCEPTION_HINT,v_diag4=RETURNED_SQLSTATE,v_diag5=PG_CONTEXT,v_diag6=PG_EXCEPTION_CONTEXT;v_ret:='line='||v_diag6||'. '||v_diag4||'. '||v_diag1;RAISE EXCEPTION'%',v_ret;RETURN'';END;END;$$;

with records as (
  select
    c.oid::int8 as ""id"",
    case c.relkind
      when 'r' then pg_temp.pg_get_tabledef(
        concat(nc.nspname),
        concat(c.relname),
        false,
        'FKEYS_INTERNAL',
        'NO_TRIGGERS'
      )
      when 'v' then concat(
        'create view ', concat(nc.nspname, '.', c.relname), ' as',
        pg_get_viewdef(concat(nc.nspname, '.', c.relname), true)
      )
      when 'm' then concat(
        'create materialized view ', concat(nc.nspname, '.', c.relname), ' as',
        pg_get_viewdef(concat(nc.nspname, '.', c.relname), true)
      )
      when 'f' then concat('create foreign table ', nc.nspname, '.', c.relname, ' ( ... )')
      when 'p' then pg_temp.pg_get_tabledef(
        concat(nc.nspname),
        concat(c.relname),
        false,
        'FKEYS_INTERNAL',
        'NO_TRIGGERS'
      )
    end as ""sql""
  from
    pg_namespace nc
    join pg_class c on nc.oid = c.relnamespace
  where
    c.relkind in ('r', 'v', 'm', 'f', 'p')
    and not pg_is_other_temp_schema(nc.oid)
    and (
      pg_has_role(c.relowner, 'USAGE')
      or has_table_privilege(
        c.oid,
        'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'
      )
      or has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')
    )
    and nc.nspname IN ('public')
  order by c.relname asc
  limit 100
  offset 0
)
select
  jsonb_build_object(
    'definitions', coalesce(jsonb_agg(
      jsonb_build_object(
        'id', r.id,
        'sql', r.sql
      )
    ), '[]'::jsonb)
  ) ""data""
from records r;

-- source: dashboard
-- user: 9ae0dcbe-6a1b-4a16-94c6-fc3cb8342b39
-- date: 2025-05-13T15:21:21.713Z",null,0840b99b-292c-4c39-b626-62fe2e403d87,garbiwdqupcjlybbshbh,1747149681862000
null,LOG,"connection authorized: user=postgres database=postgres application_name=postgres-meta 0.0.0-automated SSL enabled (protocol=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384, bits=256)",null,16e35513-4a8a-4787-891e-45c138e565d8,garbiwdqupcjlybbshbh,1747149681837000